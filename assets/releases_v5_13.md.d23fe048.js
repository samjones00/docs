import{_ as a,c as s,o as t,a as n,b as e}from"./app.6a524bd5.js";var p="/assets/net6-released.9500a41c.png";const y='{"title":"v5.13.2 Release Notes","description":"","frontmatter":{"title":"v5.13.2 Release Notes","slug":"v5-13"},"headers":[{"level":2,"title":"net6.0 TFM builds added to all packages","slug":"net6-0-tfm-builds-added-to-all-packages"},{"level":2,"title":".NET 6 new Hosting Model","slug":"net-6-new-hosting-model"},{"level":2,"title":"New Modular Startup","slug":"new-modular-startup"},{"level":3,"title":"ConfigureAppHost","slug":"configureapphost"},{"level":3,"title":"Customize AppHost at different Startup Lifecycles","slug":"customize-apphost-at-different-startup-lifecycles"},{"level":3,"title":"Removing Features","slug":"removing-features"},{"level":3,"title":"Preserve ModularStartup configuration","slug":"preserve-modularstartup-configuration"},{"level":3,"title":"Migrating to HostingStartup","slug":"migrating-to-hostingstartup"},{"level":3,"title":"Utilizing net5 mix templates","slug":"utilizing-net5-mix-templates"},{"level":2,"title":"All project templates upgraded to .NET 6","slug":"all-project-templates-upgraded-to-net-6"},{"level":2,"title":"Creating new .NET 5 projects","slug":"creating-new-net-5-projects"},{"level":3,"title":"servicestack.net/start?tag=net5","slug":"servicestack-net-start-tag-net5"},{"level":2,"title":"ServiceStackVS now supports Visual Studio 2022","slug":"servicestackvs-now-supports-visual-studio-2022"},{"level":2,"title":".NET 6 DateOnly and TimeOnly Types","slug":"net-6-dateonly-and-timeonly-types"},{"level":2,"title":"Validation now a pre-configured Feature","slug":"validation-now-a-pre-configured-feature"},{"level":2,"title":"Breaking Changes","slug":"breaking-changes"},{"level":2,"title":"Lets go .NET 6.0!","slug":"lets-go-net-6-0"},{"level":2,"title":"v4.5 .NET Framework Deprecation Notice","slug":"v4-5-net-framework-deprecation-notice"}],"relativePath":"releases/v5_13.md"}',o={},c=n('<p><a href="https://devblogs.microsoft.com/dotnet/announcing-net-6/" target="_blank" rel="noopener noreferrer"><img src="'+p+`" alt=""></a></p><p>We&#39;ve cut this release cadence short to focus on putting out a quality release to take advantage of the <a href="https://devblogs.microsoft.com/dotnet/announcing-net-6/" target="_blank" rel="noopener noreferrer">newest and best .NET runtime yet!</a></p><p>In a lot of ways .NET 6 marks the start of a new era for .NET with the first LTS release after the end of the .NET Framework and .NET Standard with only 1 actively developed runtime going forward.</p><p>In alignment with .NET&#39;s future we&#39;re looking to embracing new .NET runtime features and provide better integration with .NET 6&#39;s development model so ServiceStack can be regarded as another module in an ASP .NET Core App&#39;s pipeline, allowing knowledge to be more reusably shared and to that end will be continuing to work on deeper integrations in future releases.</p><h2 id="net6-0-tfm-builds-added-to-all-packages" tabindex="-1">net6.0 TFM builds added to all packages <a class="header-anchor" href="#net6-0-tfm-builds-added-to-all-packages" aria-hidden="true">#</a></h2><p>This release lays the foundation for the new style of Apps promoted by .NET 6.0 starting with new <strong>net6.0</strong> TFM builds added to all active ServiceStack NuGet packages. Previously ServiceStack&#39;s ASP .NET Core functionality was delivered in <strong>.NET Standard 2.0</strong> .dll&#39;s whose builds have served running ServiceStack on all .NET Core runtimes dating back to <strong>.NET Core 2.x</strong>.</p><p>The new <strong>net6.0</strong> target builds has allowed us to reference the latest versions of each ASP .NET Core dependency we use, including the recommendation of referencing the <strong>Microsoft.AspNetCore.App</strong> <code>&lt;FrameworkReference/&gt;</code> bundled with each .NET installation, a good example of this is seen in <a href="https://github.com/ServiceStack/ServiceStack/blob/master/src/ServiceStack/ServiceStack.csproj" target="_blank" rel="noopener noreferrer">ServiceStack.csproj</a>:</p><div class="language-xml"><pre><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ItemGroup</span> <span class="token attr-name">Condition</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> <span class="token punctuation">&#39;</span>$(TargetFramework)<span class="token punctuation">&#39;</span> == <span class="token punctuation">&#39;</span>netstandard2.0<span class="token punctuation">&#39;</span> <span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>System.Memory<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.5.4<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>System.ComponentModel.Annotations<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5.0.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.Extensions.Primitives<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.2.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.AspNetCore.Http<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.2.2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.AspNetCore.Http.Abstractions<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.2.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.AspNetCore.Http.Extensions<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.2.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.AspNetCore.Hosting<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.2.7<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.AspNetCore.Hosting.Abstractions<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.2.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.Extensions.Logging.Abstractions<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.2.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.Extensions.DependencyInjection<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.2.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.Extensions.DependencyInjection.Abstractions<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.2.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.AspNetCore.Cryptography.KeyDerivation<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.2.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.Extensions.Configuration.Binder<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.2.4<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.Extensions.Configuration.UserSecrets<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>2.2.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>System.Threading.Thread<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.3.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>System.Reflection.Emit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.7.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>System.Linq.Queryable<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.3.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>System.Drawing.Common<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5.0.2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ItemGroup</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ItemGroup</span> <span class="token attr-name">Condition</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span> <span class="token punctuation">&#39;</span>$(TargetFramework)<span class="token punctuation">&#39;</span> == <span class="token punctuation">&#39;</span>net6.0<span class="token punctuation">&#39;</span> <span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>FrameworkReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Microsoft.AspNetCore.App<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>System.Memory<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.5.4<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>System.ComponentModel.Annotations<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5.0.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>System.Threading.Thread<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.3.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>System.Reflection.Emit<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.7.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>System.Linq.Queryable<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>4.3.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PackageReference</span> <span class="token attr-name">Include</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>System.Drawing.Common<span class="token punctuation">&quot;</span></span> <span class="token attr-name">Version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>5.0.2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ItemGroup</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="net-6-new-hosting-model" tabindex="-1">.NET 6 new Hosting Model <a class="header-anchor" href="#net-6-new-hosting-model" aria-hidden="true">#</a></h2><p>One of the most user visible features in .NET 6 is its <a href="https://gist.github.com/davidfowl/0e0372c3c1d895c3ce195ba983b1e03d" target="_blank" rel="noopener noreferrer">new WebApplication Hosting Model</a> which unifies existing <code>Program.cs</code> and <code>Startup.cs</code> classes and takes advantage of C# 9&#39;s Top-level statements where a minimal .NET 6 Hello World Web Application can now be as small as:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> builder <span class="token operator">=</span> WebApplication<span class="token punctuation">.</span><span class="token function">CreateBuilder</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> app <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">MapGet</span><span class="token punctuation">(</span><span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>As with most new radical features the contrast can be initially jarring, with one of the initial criticisms being that it lacks the forced structure of the <code>Startup</code> and encourages App&#39;s to mix all features into a single class.</p><p>Whilst we agree it&#39;s bad practice for large Apps to maintain all their configuration in a single file, we also believe .NET 6&#39;s new Hosting Model offers a simpler App configuration as now the <code>Program.cs</code> for most new <strong>net6.0</strong> ServiceStack Project Templates looks like:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> builder <span class="token operator">=</span> WebApplication<span class="token punctuation">.</span><span class="token function">CreateBuilder</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> app <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Configure the HTTP request pipeline.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>app<span class="token punctuation">.</span>Environment<span class="token punctuation">.</span><span class="token function">IsDevelopment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token function">UseExceptionHandler</span><span class="token punctuation">(</span><span class="token string">&quot;/Error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// The default HSTS value is 30 days. You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.</span>
    app<span class="token punctuation">.</span><span class="token function">UseHsts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    app<span class="token punctuation">.</span><span class="token function">UseHttpsRedirection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

app<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>That&#39;s because now all ServiceStack&#39;s features are loaded using .NET&#39;s <code>HostingStartup</code>, including ServiceStack&#39;s <code>AppHost</code> itself that&#39;s now being configured in <a href="https://github.com/NetCoreTemplates/web/blob/master/MyApp/Configure.AppHost.cs" target="_blank" rel="noopener noreferrer">Configure.AppHost.cs</a>, e.g:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">assembly</span><span class="token punctuation">:</span> <span class="token class-name">HostingStartup</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">MyApp<span class="token punctuation">.</span>AppHost</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>

<span class="token keyword">namespace</span> <span class="token namespace">MyApp</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppHost</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AppHostBase</span><span class="token punctuation">,</span> <span class="token class-name">IHostingStartup</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IWebHostBuilder</span> builder<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> builder
        <span class="token punctuation">.</span><span class="token function">ConfigureServices</span><span class="token punctuation">(</span>services <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// Configure ASP .NET Core IOC Dependencies</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">Configure</span><span class="token punctuation">(</span>app <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// Configure ASP .NET Core App</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>HasInit<span class="token punctuation">)</span>
                app<span class="token punctuation">.</span><span class="token function">UseServiceStack</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token function">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">(</span><span class="token string">&quot;MyApp&quot;</span><span class="token punctuation">,</span> <span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">MyServices</span><span class="token punctuation">)</span><span class="token punctuation">.</span>Assembly<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">Container</span> container<span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token comment">// Configure ServiceStack only IOC, Config &amp; Plugins</span>
        <span class="token function">SetConfig</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">HostConfig</span> <span class="token punctuation">{</span>
            UseSameSiteCookies <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Whilst ServiceStack&#39;s <code>AppHost</code> remains the same, we&#39;re now recommending that it&#39;s registered using .NET&#39;s familiar <code>HostingStartup</code> so that all configuration pertaining to different features are encapsulated together allowing them to be more easily updated or replaced, e.g. each feature could be temporarily disabled by commenting out its assembly HostingStartup&#39;s attribute, including ServiceStack itself:</p><div class="language-csharp"><pre><code><span class="token comment">//[assembly: HostingStartup(typeof(MyApp.AppHost))]</span>
</code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Reason for only conditionally registering ServiceStack with <code>if (!HasInit)</code> is to allow other plugins (like Auth) the opportunity to precisely control where ServiceStack is registered within its preferred ASP .NET Core&#39;s pipeline</p></div><h2 id="new-modular-startup" tabindex="-1">New Modular Startup <a class="header-anchor" href="#new-modular-startup" aria-hidden="true">#</a></h2>`,20),u=e("iframe",{class:"video-hd",src:"https://www.youtube.com/embed/WgsFl0AFUdo",frameborder:"0",allow:"autoplay; encrypted-media",allowfullscreen:""},null,-1),l=n(`<p>Our <a href="/modular-startup">Modular Startup</a> approach has encouraged the modular configuration of ServiceStack ASP .NET Core Apps using feature encapsulated configuration blocks for a number of years. This has enabled ServiceStack Apps to be easily composed with just the features developers need, either at project creation with <a href="http://servicestack.net/start" target="_blank" rel="noopener noreferrer">servicestack.net/start</a> page or after a project&#39;s creation where features can easily be added and removed using the command-line <a href="/mix-tool">mix tool</a>.</p><p>We&#39;re now embracing .NET 6&#39;s idiom and have rewritten all our <a href="https://gist.github.com/gistlyn/9b32b03f207a191099137429051ebde8" target="_blank" rel="noopener noreferrer">mix gist config files</a> to adopt its <code>HostingStartup</code> which is better able to load modular Startup configuration without assembly scanning.</p><p>This is a standard ASP .NET Core feature that we can use to configure Mongo DB in any ASP .NET Core App with:</p><div class="language-bash"><pre><code>$ x mix mongodb
</code></pre></div><p>Which adds the <code>mongodb</code> gist file contents to your ASP .NET Core Host project:</p><div class="language-csharp"><pre><code><span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Hosting</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>Extensions<span class="token punctuation">.</span>DependencyInjection</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">MongoDB<span class="token punctuation">.</span>Driver</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">assembly</span><span class="token punctuation">:</span> <span class="token class-name">HostingStartup</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">MyApp<span class="token punctuation">.</span>ConfigureMongoDb</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>

<span class="token keyword">namespace</span> <span class="token namespace">MyApp</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigureMongoDb</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IHostingStartup</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IWebHostBuilder</span> builder<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> builder
            <span class="token punctuation">.</span><span class="token function">ConfigureServices</span><span class="token punctuation">(</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> services<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token class-name"><span class="token keyword">var</span></span> mongoClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MongoClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">IMongoDatabase</span> mongoDatabase <span class="token operator">=</span> mongoClient<span class="token punctuation">.</span><span class="token function">GetDatabase</span><span class="token punctuation">(</span><span class="token string">&quot;MyApp&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                services<span class="token punctuation">.</span><span class="token function">AddSingleton</span><span class="token punctuation">(</span>mongoDatabase<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>    
<span class="token punctuation">}</span>
</code></pre></div><p>As it&#39;s not a ServiceStack feature it can be used to configure ASP .NET Core Apps with any feature, e.g. we could also easily configure <a href="https://martendb.io" target="_blank" rel="noopener noreferrer">Marten</a> in an ASP .NET Core App with:</p><div class="language-bash"><pre><code>$ x mix marten
</code></pre></div><p>The benefit of this approach is entire modules of features can be configured in a single command, e.g. An empty ServiceStack App can be configured with MongoDB, ServiceStack Auth and a MongoDB Auth Repository with a single command:</p><div class="language-bash"><pre><code>$ x mix auth auth-mongodb mongodb
</code></pre></div><p>Likewise should you wish, you can replace MongoDB with a completely different PostgreSQL RDBMS implementation by running:</p><div class="language-bash"><pre><code>$ x mix auth auth-db postgres
</code></pre></div><h3 id="configureapphost" tabindex="-1">ConfigureAppHost <a class="header-anchor" href="#configureapphost" aria-hidden="true">#</a></h3><p>Looking deeper, we can see where we&#39;re plugins are able to configure ServiceStack via the <code>.ConfigureAppHost()</code> extension method:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">assembly</span><span class="token punctuation">:</span> <span class="token class-name">HostingStartup</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">MyApp<span class="token punctuation">.</span>ConfigureAuth</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>

<span class="token keyword">namespace</span> <span class="token namespace">MyApp</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Add any additional metadata properties you want to store in the Users Typed Session</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomUserSession</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AuthUserSession</span></span>
    <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Custom Validator to add custom validators to built-in /register Service requiring DisplayName and ConfirmPassword</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomRegistrationValidator</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">RegistrationValidator</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token function">CustomRegistrationValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token function">RuleSet</span><span class="token punctuation">(</span>ApplyTo<span class="token punctuation">.</span>Post<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token punctuation">{</span>
                <span class="token function">RuleFor</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>DisplayName<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">NotEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token function">RuleFor</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x<span class="token punctuation">.</span>ConfirmPassword<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">NotEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigureAuth</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IHostingStartup</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IWebHostBuilder</span> builder<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> builder
            <span class="token punctuation">.</span><span class="token function">ConfigureServices</span><span class="token punctuation">(</span>services <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token comment">//services.AddSingleton&lt;ICacheClient&gt;(new MemoryCacheClient()); //Store User Sessions in Memory Cache (default)</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ConfigureAppHost</span><span class="token punctuation">(</span>appHost <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token class-name"><span class="token keyword">var</span></span> appSettings <span class="token operator">=</span> appHost<span class="token punctuation">.</span>AppSettings<span class="token punctuation">;</span>
                appHost<span class="token punctuation">.</span>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AuthFeature</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">CustomUserSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">IAuthProvider<span class="token punctuation">[</span><span class="token punctuation">]</span></span> <span class="token punctuation">{</span>
                        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">CredentialsAuthProvider</span><span class="token punctuation">(</span>appSettings<span class="token punctuation">)</span><span class="token punctuation">,</span>     <span class="token comment">/* Sign In with Username / Password credentials */</span>
                        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FacebookAuthProvider</span><span class="token punctuation">(</span>appSettings<span class="token punctuation">)</span><span class="token punctuation">,</span>        <span class="token comment">/* Create App https://developers.facebook.com/apps */</span>
                        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">GoogleAuthProvider</span><span class="token punctuation">(</span>appSettings<span class="token punctuation">)</span><span class="token punctuation">,</span>          <span class="token comment">/* Create App https://console.developers.google.com/apis/credentials */</span>
                        <span class="token keyword">new</span> <span class="token constructor-invocation class-name">MicrosoftGraphAuthProvider</span><span class="token punctuation">(</span>appSettings<span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">/* Create App https://apps.dev.microsoft.com */</span>
                    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                appHost<span class="token punctuation">.</span>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">RegistrationFeature</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//Enable /register Service</span>

                <span class="token comment">//override the default registration validation with your own custom implementation</span>
                appHost<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">RegisterAs</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>CustomRegistrationValidator<span class="token punctuation">,</span> IValidator<span class="token punctuation">&lt;</span>Register<span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>By default any AppHost configuration is called before <code>AppHost.Configure()</code> is run, the AppHost can be further customized after it&#39;s run:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">assembly</span><span class="token punctuation">:</span> <span class="token class-name">HostingStartup</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">MyApp<span class="token punctuation">.</span>ConfigureAuthRepository</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>

<span class="token keyword">namespace</span> <span class="token namespace">MyApp</span>
<span class="token punctuation">{</span>
    <span class="token comment">// Custom User Table with extended Metadata properties</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppUser</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">UserAuth</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> ProfileUrl <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> LastLoginIp <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
        <span class="token keyword">public</span> <span class="token return-type class-name">DateTime<span class="token punctuation">?</span></span> LastLoginDate <span class="token punctuation">{</span> <span class="token keyword">get</span><span class="token punctuation">;</span> <span class="token keyword">set</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AppUserAuthEvents</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">AuthEvents</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">OnAuthenticated</span><span class="token punctuation">(</span><span class="token class-name">IRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">IAuthSession</span> session<span class="token punctuation">,</span> <span class="token class-name">IServiceBase</span> authService<span class="token punctuation">,</span> 
            <span class="token class-name">IAuthTokens</span> tokens<span class="token punctuation">,</span> <span class="token class-name">Dictionary<span class="token punctuation">&lt;</span><span class="token keyword">string</span><span class="token punctuation">,</span> <span class="token keyword">string</span><span class="token punctuation">&gt;</span></span> authInfo<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token keyword">var</span></span> authRepo <span class="token operator">=</span> HostContext<span class="token punctuation">.</span>AppHost<span class="token punctuation">.</span><span class="token function">GetAuthRepository</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">using</span> <span class="token punctuation">(</span>authRepo <span class="token keyword">as</span> <span class="token class-name">IDisposable</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token class-name"><span class="token keyword">var</span></span> userAuth <span class="token operator">=</span> <span class="token punctuation">(</span>AppUser<span class="token punctuation">)</span>authRepo<span class="token punctuation">.</span><span class="token function">GetUserAuth</span><span class="token punctuation">(</span>session<span class="token punctuation">.</span>UserAuthId<span class="token punctuation">)</span><span class="token punctuation">;</span>
                userAuth<span class="token punctuation">.</span>ProfileUrl <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">GetProfileUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                userAuth<span class="token punctuation">.</span>LastLoginIp <span class="token operator">=</span> req<span class="token punctuation">.</span>UserHostAddress<span class="token punctuation">;</span>
                userAuth<span class="token punctuation">.</span>LastLoginDate <span class="token operator">=</span> DateTime<span class="token punctuation">.</span>UtcNow<span class="token punctuation">;</span>
                authRepo<span class="token punctuation">.</span><span class="token function">SaveUserAuth</span><span class="token punctuation">(</span>userAuth<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigureAuthRepository</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IHostingStartup</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IWebHostBuilder</span> builder<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> builder
            <span class="token punctuation">.</span><span class="token function">ConfigureServices</span><span class="token punctuation">(</span>services <span class="token operator">=&gt;</span> services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddSingleton</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IAuthRepository<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>c <span class="token operator">=&gt;</span>
                <span class="token keyword">new</span> <span class="token constructor-invocation class-name">OrmLiteAuthRepository<span class="token punctuation">&lt;</span>AppUser<span class="token punctuation">,</span> UserAuthDetails<span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>c<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Resolve</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IDbConnectionFactory<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    UseDistinctRoleTables <span class="token operator">=</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ConfigureAppHost</span><span class="token punctuation">(</span>appHost <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token class-name"><span class="token keyword">var</span></span> authRepo <span class="token operator">=</span> appHost<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">Resolve</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>IAuthRepository<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                authRepo<span class="token punctuation">.</span><span class="token function">InitSchema</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// CreateUser(authRepo, &quot;admin@email.com&quot;, &quot;Admin User&quot;, &quot;p@55wOrd&quot;, roles:new[]{ RoleNames.Admin });</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token named-parameter punctuation">afterConfigure</span><span class="token punctuation">:</span> appHost <span class="token operator">=&gt;</span> 
                appHost<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AssertPlugin</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>AuthFeature<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>AuthEvents<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AppUserAuthEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Add initial Users to the configured Auth Repository</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">CreateUser</span><span class="token punctuation">(</span><span class="token class-name">IAuthRepository</span> authRepo<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> email<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> name<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span></span> password<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span></span> roles<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>authRepo<span class="token punctuation">.</span><span class="token function">GetUserAuthByUserName</span><span class="token punctuation">(</span>email<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
            <span class="token punctuation">{</span>
                <span class="token class-name"><span class="token keyword">var</span></span> newAdmin <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">AppUser</span> <span class="token punctuation">{</span> Email <span class="token operator">=</span> email<span class="token punctuation">,</span> DisplayName <span class="token operator">=</span> name <span class="token punctuation">}</span><span class="token punctuation">;</span>
                <span class="token class-name"><span class="token keyword">var</span></span> user <span class="token operator">=</span> authRepo<span class="token punctuation">.</span><span class="token function">CreateUserAuth</span><span class="token punctuation">(</span>newAdmin<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
                authRepo<span class="token punctuation">.</span><span class="token function">AssignRoles</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> roles<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="customize-apphost-at-different-startup-lifecycles" tabindex="-1">Customize AppHost at different Startup Lifecycles <a class="header-anchor" href="#customize-apphost-at-different-startup-lifecycles" aria-hidden="true">#</a></h3><p>To cater for all plugins, AppHost configurations can be registered at different stages within the AppHost&#39;s initialization:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IWebHostBuilder</span> builder<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> builder
    <span class="token punctuation">.</span><span class="token function">ConfigureAppHost</span><span class="token punctuation">(</span>
        <span class="token named-parameter punctuation">beforeConfigure</span><span class="token punctuation">:</span>    appHost <span class="token operator">=&gt;</span> <span class="token comment">/* fired before AppHost.Configure() */</span><span class="token punctuation">,</span> 
        <span class="token named-parameter punctuation">afterConfigure</span><span class="token punctuation">:</span>     appHost <span class="token operator">=&gt;</span> <span class="token comment">/* fired after AppHost.Configure() */</span><span class="token punctuation">,</span>
        <span class="token named-parameter punctuation">afterPluginsLoaded</span><span class="token punctuation">:</span> appHost <span class="token operator">=&gt;</span> <span class="token comment">/* fired after plugins are loaded */</span><span class="token punctuation">,</span>
        <span class="token named-parameter punctuation">afterAppHostInit</span><span class="token punctuation">:</span>   appHost <span class="token operator">=&gt;</span> <span class="token comment">/* fired after AppHost has initialized */</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="removing-features" tabindex="-1">Removing Features <a class="header-anchor" href="#removing-features" aria-hidden="true">#</a></h3><p>The benefits of adopting a modular approach to AppHost configuration is the same as general organizational code structure which results in better decoupling and cohesion where it&#39;s easier to determine all the dependencies of a feature, easier to update, less chance of unintended side-effects, easier to share standard configuration amongst multiple projects and easier to remove the feature entirely, either temporarily if needing to isolate &amp; debug a runtime issue by:</p><div class="language-csharp"><pre><code><span class="token comment">// [assembly: HostingStartup(typeof(MyApp.ConfigureAuth))]</span>
</code></pre></div><p>Or easier to permanently replace or remove features by either directly deleting the isolated <code>*.cs</code> source files or by undoing mixing in the feature using <code>mix -delete</code>, e.g:</p><div class="language-bash"><pre><code>$ x mix -delete auth auth-db postgres
</code></pre></div><p>Which works similar to package managers where it removes all files contained within each mix gist.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Please see the <a href="https://gist.github.com/gistlyn/9b32b03f207a191099137429051ebde8#file-mix_howto-md" target="_blank" rel="noopener noreferrer">Mix HowTo</a> to find out how you can contribute your own gist mix features</p></div><h3 id="preserve-modularstartup-configuration" tabindex="-1">Preserve ModularStartup configuration <a class="header-anchor" href="#preserve-modularstartup-configuration" aria-hidden="true">#</a></h3><p>Whilst using <code>HostingStartup</code> is recommended going forward, your existing <code>ModularStartup</code> classes will work without change when upgrading your projects to .NET6.</p><p>If you want to take advantage of the new .NET6 top-level host builder to side-step the need for a <code>Startup</code> class, you can still reuse and preserve your modular startup by adding <code>Services.AddModularStartup&lt;AppHost&gt;()</code> method before calling <code>builder.Build();</code>, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> builder <span class="token operator">=</span> WebApplication<span class="token punctuation">.</span><span class="token function">CreateBuilder</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
builder<span class="token punctuation">.</span>Services<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AddModularStartup</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>AppHost<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span>Configuration<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> app <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token function">UseServiceStack</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>AppHost</code> registration has become slightly easier to enable ServiceStack in this release when using the <code>NetCoreAppSettings</code>, as you no longer need to manually inject the <code>IConfiguration</code> class as it&#39;s now automatically populated by default :</p><div class="language-csharp"><pre><code><span class="token comment">// Previously</span>
app<span class="token punctuation">.</span><span class="token function">UseServiceStack</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AppHost</span>
<span class="token punctuation">{</span>
    AppSettings <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">NetCoreAppSettings</span><span class="token punctuation">(</span>builder<span class="token punctuation">.</span>Configuration<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// New</span>
app<span class="token punctuation">.</span><span class="token function">UseServiceStack</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="migrating-to-hostingstartup" tabindex="-1">Migrating to HostingStartup <a class="header-anchor" href="#migrating-to-hostingstartup" aria-hidden="true">#</a></h3><p>As we&#39;ll be using the new <code>HostingStartup</code> model going forward we recommend migrating your existing configuration to use them.</p><p>To help with this you can refer to the <a href="https://github.com/ServiceStack/mix/commit/b56746622aa1879e3e6a8cbf835e634f05db30db" target="_blank" rel="noopener noreferrer">mix diff</a> showing how each of the existing mix configurations were converted to the new model.</p><p>As a concrete example, lets take a look at the steps used to migrate our Chinook example application <a href="https://github.com/NetCoreApps/Chinook/commit/2758af9deae9c3aa910a27134f95167f7ec6e541" target="_blank" rel="noopener noreferrer">from NET5 using the previous <code>Startup : ModularStartup</code>, to the new <code>HostingStartup</code></a>.</p><h4 id="step-1" tabindex="-1">Step 1 <a class="header-anchor" href="#step-1" aria-hidden="true">#</a></h4><p>Migrate your existing <code>ConfigureServices</code> and <code>Configure(IApplicationBuilder)</code> from <code>Startup : ModularStartup</code> to the top-level host builder in <code>Program.cs</code>. Eg</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> builder <span class="token operator">=</span> WebApplication<span class="token punctuation">.</span><span class="token function">CreateBuilder</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> app <span class="token operator">=</span> builder<span class="token punctuation">.</span><span class="token function">Build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Configure the HTTP request pipeline.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>app<span class="token punctuation">.</span>Environment<span class="token punctuation">.</span><span class="token function">IsDevelopment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    app<span class="token punctuation">.</span><span class="token function">UseExceptionHandler</span><span class="token punctuation">(</span><span class="token string">&quot;/Error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// The default HSTS value is 30 days. </span>
    <span class="token comment">// You may want to change this for production scenarios, see https://aka.ms/aspnetcore-hsts.</span>
    app<span class="token punctuation">.</span><span class="token function">UseHsts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    app<span class="token punctuation">.</span><span class="token function">UseHttpsRedirection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

app<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="step-2" tabindex="-1">Step 2 <a class="header-anchor" href="#step-2" aria-hidden="true">#</a></h4><p>Move your <code>AppHost</code> class to a new <code>Configure.AppHost.cs</code> file.</p><h4 id="step-3" tabindex="-1">Step 3 <a class="header-anchor" href="#step-3" aria-hidden="true">#</a></h4><p>Implement <code>IHostingStartup</code> on your AppHost with automatic initialization. Eg:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IWebHostBuilder</span> builder<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    builder<span class="token punctuation">.</span><span class="token function">ConfigureServices</span><span class="token punctuation">(</span>services <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// Configure ASP.NET Core IOC Dependencies</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">Configure</span><span class="token punctuation">(</span>app <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// Configure ASP.NET Core App</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>HasInit<span class="token punctuation">)</span>
                app<span class="token punctuation">.</span><span class="token function">UseServiceStack</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AppHost</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="step-4" tabindex="-1">Step 4 <a class="header-anchor" href="#step-4" aria-hidden="true">#</a></h4><p>Declare <code>assembly: HostingStartup</code> for your <code>AppHost</code> in the same <code>Configure.AppHost.cs</code>. Eg:</p><div class="language-csharp"><pre><code><span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">assembly</span><span class="token punctuation">:</span> <span class="token class-name">HostingStartup</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">Chinook<span class="token punctuation">.</span>AppHost</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>
</code></pre></div><h4 id="step-5" tabindex="-1">Step 5 <a class="header-anchor" href="#step-5" aria-hidden="true">#</a></h4><p>Migrate each existing modular startup class that implements <code>IConfgiureServices</code> and/or <code>IConfigureApp</code> to use <code>IHostingStartup</code>. Eg:</p><div class="language-csharp"><pre><code><span class="token comment">// net5.0 modular startup</span>
<span class="token keyword">using</span> <span class="token namespace">ServiceStack</span><span class="token punctuation">;</span>

<span class="token keyword">namespace</span> <span class="token namespace">Chinook</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigureAutoQuery</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IConfigureAppHost</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IAppHost</span> appHost<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            appHost<span class="token punctuation">.</span>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span> <span class="token punctuation">{</span>
                MaxLimit <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span>
                IncludeTotal <span class="token operator">=</span> <span class="token boolean">true</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-csharp"><pre><code><span class="token comment">// net6.0 modular startup using IHostingStartup</span>
<span class="token keyword">using</span> <span class="token namespace">Microsoft<span class="token punctuation">.</span>AspNetCore<span class="token punctuation">.</span>Hosting</span><span class="token punctuation">;</span>
<span class="token keyword">using</span> <span class="token namespace">ServiceStack</span><span class="token punctuation">;</span>

<span class="token punctuation">[</span><span class="token attribute"><span class="token target keyword">assembly</span><span class="token punctuation">:</span> <span class="token class-name">HostingStartup</span><span class="token attribute-arguments"><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name">Chinook<span class="token punctuation">.</span>ConfigureAutoQuery</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token punctuation">]</span>

<span class="token keyword">namespace</span> <span class="token namespace">Chinook</span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConfigureAutoQuery</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">IHostingStartup</span></span>
    <span class="token punctuation">{</span>
        <span class="token keyword">public</span> <span class="token return-type class-name"><span class="token keyword">void</span></span> <span class="token function">Configure</span><span class="token punctuation">(</span><span class="token class-name">IWebHostBuilder</span> builder<span class="token punctuation">)</span>
        <span class="token punctuation">{</span>
            builder<span class="token punctuation">.</span><span class="token function">ConfigureAppHost</span><span class="token punctuation">(</span>appHost <span class="token operator">=&gt;</span>
            <span class="token punctuation">{</span>
                appHost<span class="token punctuation">.</span>Plugins<span class="token punctuation">.</span><span class="token function">Add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">AutoQueryFeature</span> <span class="token punctuation">{</span>
                    MaxLimit <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">,</span>
                    IncludeTotal <span class="token operator">=</span> <span class="token boolean">true</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Remembering also that infrastructure like your <code>Dockerfile</code> or host will likely need the runtimes/SDKs updated as well.</p></blockquote><h3 id="utilizing-net5-mix-templates" tabindex="-1">Utilizing net5 mix templates <a class="header-anchor" href="#utilizing-net5-mix-templates" aria-hidden="true">#</a></h3><p>To support older projects the <a href="https://gist.github.com/gistlyn/7362ea802aef361bbdc21097b6a99e0d" target="_blank" rel="noopener noreferrer">Existing ModularStartup configuration</a> can still be used for when running on earlier .NET Core runtimes with the mix tool by setting its gist Id in the <code>MIX_SOURCE</code> Environment Variable, e.g:</p><div class="language-bash"><pre><code>$ <span class="token assign-left variable">MIX_SOURCE</span><span class="token operator">=</span>7362ea802aef361bbdc21097b6a99e0d x mix
</code></pre></div><p>Which will use the older mix configuration as its source.</p><h2 id="all-project-templates-upgraded-to-net-6" tabindex="-1">All project templates upgraded to .NET 6 <a class="header-anchor" href="#all-project-templates-upgraded-to-net-6" aria-hidden="true">#</a></h2><p>As an LTS release we expect everyone will want to upgrade to .NET 6 as soon as possible to take advantage of .NET&#39;s best &amp; fastest runtime yet. We&#39;re already using .NET 6 in production and haven&#39;t come across any reason not to upgrade yet.</p><p>With the project templates upgraded, you can now create a new ServiceStack .NET 6 App with <a href="/dotnet-new">x new</a>:</p><div class="language-csharp"><pre><code>$ x <span class="token keyword">new</span>
</code></pre></div><p>Or from our online project template creator at:</p><h1 id="servicestack-net-start" tabindex="-1"><a href="http://servicestack.net/start" target="_blank" rel="noopener noreferrer">servicestack.net/start</a> <a class="header-anchor" href="#servicestack-net-start" aria-hidden="true">#</a></h1><h2 id="creating-new-net-5-projects" tabindex="-1">Creating new .NET 5 projects <a class="header-anchor" href="#creating-new-net-5-projects" aria-hidden="true">#</a></h2><p>If you&#39;re not yet ready to move to .NET 6 you can still create new project templates of older versions of <a href="https://github.com/NetCoreTemplates/" target="_blank" rel="noopener noreferrer">.NET Core project templates</a>.</p><p>Where we&#39;ve added .NET 5 project template support to our online Project creator page at:</p><h3 id="servicestack-net-start-tag-net5" tabindex="-1"><a href="http://servicestack.net/start?tag=net5" target="_blank" rel="noopener noreferrer">servicestack.net/start?tag=net5</a> <a class="header-anchor" href="#servicestack-net-start-tag-net5" aria-hidden="true">#</a></h3><p>Otherwise our .NET Core project templates have had their last .NET 5.0 version tagged with <code>net5</code> which can be installed with the <code>x</code> tool by using the full URL of its Source Code <strong>.zip</strong> archive in place of the Template name, e.g:</p><div class="language-bash"><pre><code>$ x new https://github.com/NetCoreTemplates/<span class="token operator">&lt;</span>template<span class="token operator">&gt;</span>/archive/refs/tags/net5.zip ProjectName
</code></pre></div><h2 id="servicestackvs-now-supports-visual-studio-2022" tabindex="-1">ServiceStackVS now supports Visual Studio 2022 <a class="header-anchor" href="#servicestackvs-now-supports-visual-studio-2022" aria-hidden="true">#</a></h2><p><a href="https://docs.servicestack.net/templates-install-servicestackvs" target="_blank" rel="noopener noreferrer"><img src="https://raw.githubusercontent.com/ServiceStack/docs/master/docs/images/ssvs/vs-extensions-ssvs.png" alt=""></a></p><p>Developers that have upgraded to Visual Studio 2022 can now use the Add ServiceStack Reference tooling for C#, TypeScript, F# and VB-NET!</p><p>The latest update supports both Visual Studio 2019 and 2022. If you are using an older version of Visual Studio, the <a href="https://docs.servicestack.net/templates-install-servicestackvs#visual-studio-2013-2017" target="_blank" rel="noopener noreferrer">previous version can still be downloaded here</a>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>Project templates are no longer a part of the Visual Studio Extension, instead developers can use <a href="https://docs.servicestack.net/templates-overview" target="_blank" rel="noopener noreferrer"><code>x new</code></a> or <a href="https://servicestack.net/start" target="_blank" rel="noopener noreferrer">Getting Started</a> page on the ServiceStack website.</p></div><h2 id="net-6-dateonly-and-timeonly-types" tabindex="-1">.NET 6 <code>DateOnly</code> and <code>TimeOnly</code> Types <a class="header-anchor" href="#net-6-dateonly-and-timeonly-types" aria-hidden="true">#</a></h2><p>To be able to more intently capture whole Dates and Times, .NET 6 sees the introduction of new <a href="https://devblogs.microsoft.com/dotnet/date-time-and-time-zone-enhancements-in-net-6/" target="_blank" rel="noopener noreferrer">DateOnly and TimeOnly Value Types</a> which we expect to be a welcomed addition to Data Models so we&#39;ve added built-in support for them in our <a href="https://github.com/ServiceStack/ServiceStack.Text" target="_blank" rel="noopener noreferrer">JSON, JSV and CSV Text Serializers</a> as well as for persistance in <a href="https://github.com/ServiceStack/ServiceStack.OrmLite" target="_blank" rel="noopener noreferrer">OrmLite</a> Data Models.</p><h2 id="validation-now-a-pre-configured-feature" tabindex="-1">Validation now a pre-configured Feature <a class="header-anchor" href="#validation-now-a-pre-configured-feature" aria-hidden="true">#</a></h2><p>Like ASP .NET Core itself, ServiceStack is primarily a modular Pay-to-Play framework with its functionality included as removable plugins where we <a href="/plugins#auto-registered-plugins">limit built-ins to the bare essentials</a> so unused features have no effect at runtime as well as to not prohibitively discourage better implementations from competing with defaults.</p><p><a href="/validation#validation-feature">Validation</a> has become one of those features which many people have come to rely on, where a popular reported issue is that is expected to work out-of-the-box. As it&#39;s based on an opinionated <a href="https://fluentvalidation.net" target="_blank" rel="noopener noreferrer">FluentValidation</a> library we were hesitant to register it by default to leave room should a better and more ergonomic implementation for .NET was created, but as that hasn&#39;t happened we&#39;ve built-in and extended validation support to add support for <a href="/declarative-validation#type-validators">Type Validators</a>, <a href="/declarative-validation#type-validators">Declarative Validation Attributes</a> and dynamic data sources like <a href="/declarative-validation#db-validation-rules">DB Validation Rules</a>.</p><p>As it&#39;s a popular feature used in APIs we&#39;ve upgraded it to a pre-registered plugin so it no longer needs to be explicitly registered:</p><div class="language-csharp"><pre><code><span class="token comment">// Plugins.Add(new ValidationFeature());</span>
</code></pre></div><p>For Backwards compatibility we&#39;ll emit a warning if it&#39;s explicitly registered, and remove the pre-registered plugin.</p><p>Like other <a href="/plugins#plugin-api">Auto-registered Plugins</a> it can be resolved from the <code>Plugins</code> collection or AppHost:</p><div class="language-csharp"><pre><code><span class="token class-name"><span class="token keyword">var</span></span> feature <span class="token operator">=</span> Plugins<span class="token punctuation">.</span><span class="token function">FirstOrDefault</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x <span class="token keyword">is</span> <span class="token class-name">ValidationFeature</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token class-name"><span class="token keyword">var</span></span> feature <span class="token operator">=</span> appHost<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">AssertPlugin</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>ValidationFeature<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// throw if not registered</span>
</code></pre></div><p>And likewise can be removed from the <code>Plugins</code> collection or Feature Flags:</p><div class="language-csharp"><pre><code>Plugins<span class="token punctuation">.</span><span class="token function">RemoveAll</span><span class="token punctuation">(</span>x <span class="token operator">=&gt;</span> x <span class="token keyword">is</span> <span class="token class-name">ValidationFeature</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 

<span class="token function">SetConfig</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">HostConfig</span> <span class="token punctuation">{</span>
    EnableFeatures <span class="token operator">=</span> Feature<span class="token punctuation">.</span>All<span class="token punctuation">.</span><span class="token function">Remove</span><span class="token punctuation">(</span>Feature<span class="token punctuation">.</span>Validation<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="breaking-changes" tabindex="-1">Breaking Changes <a class="header-anchor" href="#breaking-changes" aria-hidden="true">#</a></h2><p>One breaking change that was unavoidable after adding .NET 6 TFM builds was needing to rename <a href="/ormlite/ormlite-apis#updateonly">UpdateOnly OrmLite APIs</a> to resolve new C# compiler ambiguous method overload errors.</p><p>Previously <code>UpdateOnly()</code> APIs accepted either a lambda expression where the fields to update would be inferred by the constructor Expression or it could accept a Data Model Instance which requires explicitly specifying which Properties of the Data Model should be updated, e.g. both of these are API Examples have the same behavior:</p><div class="language-csharp"><pre><code>db<span class="token punctuation">.</span><span class="token function">UpdateOnly</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> FirstName <span class="token operator">=</span> <span class="token string">&quot;Ty&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">UpdateOnly</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> FirstName <span class="token operator">=</span> <span class="token string">&quot;Ty&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">27</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name"><span class="token keyword">var</span></span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Person</span> <span class="token punctuation">{</span> FirstName <span class="token operator">=</span> <span class="token string">&quot;Ty&quot;</span><span class="token punctuation">,</span> Age <span class="token operator">=</span> <span class="token number">27</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">UpdateOnly</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token named-parameter punctuation">onlyFields</span><span class="token punctuation">:</span> p <span class="token operator">=&gt;</span> p<span class="token punctuation">.</span>FirstName<span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">UpdateOnly</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token named-parameter punctuation">onlyFields</span><span class="token punctuation">:</span> p <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> p<span class="token punctuation">.</span>FirstName<span class="token punctuation">,</span> p<span class="token punctuation">.</span>Age <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This now results in a build error so we&#39;ve renamed the instance UpdateOnly APIs to <code>UpdateOnlyFields</code>, e.g:</p><div class="language-csharp"><pre><code>db<span class="token punctuation">.</span><span class="token function">UpdateOnlyFields</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token named-parameter punctuation">onlyFields</span><span class="token punctuation">:</span> p <span class="token operator">=&gt;</span> p<span class="token punctuation">.</span>FirstName<span class="token punctuation">)</span><span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">UpdateOnlyFields</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token named-parameter punctuation">onlyFields</span><span class="token punctuation">:</span> p <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token punctuation">{</span> p<span class="token punctuation">.</span>FirstName<span class="token punctuation">,</span> p<span class="token punctuation">.</span>Age <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>Basically if you encounter a build error after upgrading you&#39;ll need to add a <code>*Fields</code> suffix to the <code>UpdateOnly</code> method name.</p><h2 id="lets-go-net-6-0" tabindex="-1">Lets go .NET 6.0! <a class="header-anchor" href="#lets-go-net-6-0" aria-hidden="true">#</a></h2><p>Despite only being a minor feature release, it in some ways marks a turning point for ServiceStack where we can look beyond the Legacy .NET Framework and .NET Standard past and focus new features that enable deeper integrations on the single unified .NET Runtime of .NET&#39;s future, we&#39;re excited to have ServiceStack join the .NET 6 party and look forward to resume working on our next feature release.</p><p>If you run into any issues please let us know in the <a href="https://forums.servicestack.net" target="_blank" rel="noopener noreferrer">Customer Forums</a> or <a href="https://github.com/ServiceStack/Issues" target="_blank" rel="noopener noreferrer">Issue Tracker</a>.</p><h2 id="v4-5-net-framework-deprecation-notice" tabindex="-1">v4.5 .NET Framework Deprecation Notice <a class="header-anchor" href="#v4-5-net-framework-deprecation-notice" aria-hidden="true">#</a></h2><p>In an effort to streamline the supported runtimes ServiceStack runs on we intend on following <a href="https://docs.microsoft.com/en-us/lifecycle/products/microsoft-net-framework" target="_blank" rel="noopener noreferrer">Microsoft .NET Framework end of support dates</a> and drop support for .NET v4.5 in after its support end date at <strong>April 26, 2022</strong>.</p><p>We&#39;re already forced to maintain multiple minimum .NET Framework version requirements in a number of packages with 3rd Party dependencies lacking .NET 4.5 TFM builds so our packages currently have a mix of different minimum version requirements. To consolidate all .NET Framework builds to use a single version we intend on upgrading the <strong>minimum version</strong> to <strong>.NET Framework v4.7.2</strong> after <strong>April 26, 2022</strong>.</p><p>If you&#39;re currently running ServiceStack on .NET <strong>v4.5 or v4.6</strong> and intend to continue updating to newer versions we encourage you to start planning your upgrade to a newer .NET Framework <strong>on or after v4.7.2</strong>.</p><p>If you&#39;re unable to upgrade for any reason please let us know in the <a href="https://forums.servicestack.net" target="_blank" rel="noopener noreferrer">Customer Forums</a> so we can measure the number of Customers affected for consideration in lowering our minimum .NET Framework requirements.</p>`,101),i=[c,u,l];function r(k,d,g,m,h,f){return t(),s("div",null,i)}var w=a(o,[["render",r]]);export{y as __pageData,w as default};
