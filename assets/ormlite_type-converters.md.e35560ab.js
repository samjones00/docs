import{_ as n,c as s,o as a,a as e}from"./app.877820b6.js";const h='{"title":"OrmLite Type Converters","description":"","frontmatter":{"title":"OrmLite Type Converters"},"headers":[{"level":2,"title":"Encapsulated, reusable, customizable and debuggable","slug":"encapsulated-reusable-customizable-and-debuggable"},{"level":2,"title":"Creating Converters","slug":"creating-converters"},{"level":2,"title":"Registering Converters","slug":"registering-converters"},{"level":2,"title":"Resolving Converters","slug":"resolving-converters"},{"level":2,"title":"Debugging Converters","slug":"debugging-converters"},{"level":2,"title":"Enhancing an existing Converter","slug":"enhancing-an-existing-converter"},{"level":2,"title":"SQL Server TIME Converter","slug":"sql-server-time-converter"},{"level":2,"title":"Customizable Field Definitions","slug":"customizable-field-definitions"},{"level":2,"title":"Compact Guid Converters","slug":"compact-guid-converters"},{"level":2,"title":"String Converters","slug":"string-converters"},{"level":2,"title":"DateTime Converters","slug":"datetime-converters"},{"level":3,"title":"Specify the DateKind in DateTimes","slug":"specify-the-datekind-in-datetimes"},{"level":2,"title":"Noda Time","slug":"noda-time"},{"level":2,"title":"SQL Server Types","slug":"sql-server-types"}],"relativePath":"ormlite/type-converters.md"}',t={},o=e(`<p>OrmLite has become a lot more customizable and extensible thanks to the internal redesign decoupling all custom logic for handling different Field Types into individual Type Converters.</p><p>This use of individual decoupled Type Converters makes it possible to enhance or entirely replace how .NET Types are handled and can also be extended to support new Types it has no knowledge about, a feature taken advantage of by the <a href="/ormlite/sql-server-features#sql-server-types">SQL Server Types</a> support.</p><p><img src="https://raw.githubusercontent.com/ServiceStack/Assets/master/img/release-notes/ormlite-converters.png" alt=""></p><h2 id="encapsulated-reusable-customizable-and-debuggable" tabindex="-1">Encapsulated, reusable, customizable and debuggable <a class="header-anchor" href="#encapsulated-reusable-customizable-and-debuggable" aria-hidden="true">#</a></h2><p>Converters allow for great re-use as common functionality to support each type is maintained in the common <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/tree/master/src/ServiceStack.OrmLite/Converters" target="_blank" rel="noopener noreferrer">ServiceStack.OrmLite/Converters</a> whilst any RDBMS-specific functionality can inherit the common converters and provide any specialization required to support that type. E.g. SQL Server specific converters are maintained in <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/tree/master/src/ServiceStack.OrmLite.SqlServer/Converters" target="_blank" rel="noopener noreferrer">ServiceStack.OrmLite.SqlServer/Converters</a> with each converter inheriting shared functionality and only adding custom logic required to support that Type in Sql Server.</p><h2 id="creating-converters" tabindex="-1">Creating Converters <a class="header-anchor" href="#creating-converters" aria-hidden="true">#</a></h2><p>Converters also provide good encapsulation as everything relating to handling the field type is contained within a single class definition. A Converter is any class implementing <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/blob/master/src/ServiceStack.OrmLite/IOrmLiteConverter.cs" target="_blank" rel="noopener noreferrer">IOrmLiteConverter</a> although, it&#39;s instead recommended inheriting from the <code>OrmLiteConverter</code> abstract class which allows only the minimum APIs needing to be overridden, namely the <code>ColumnDefinition</code> used when creating the Table definition and the <a href="http://ADO.NET" target="_blank" rel="noopener noreferrer">ADO.NET</a> <code>DbType</code> it should use in parameterized queries. An example of this is in <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/blob/master/src/ServiceStack.OrmLite/Converters/GuidConverter.cs" target="_blank" rel="noopener noreferrer">GuidConverter</a>:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GuidConverter</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">OrmLiteConverter</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> ColumnDefinition <span class="token operator">=&gt;</span> <span class="token string">&quot;GUID&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name">DbType</span> DbType <span class="token operator">=&gt;</span> DbType<span class="token punctuation">.</span>Guid<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>For this to work in SQL Server the <code>ColumnDefinition</code> should instead be <strong>UniqueIdentifier</strong> which is also what it needs to be cast to, to be able to query Guid&#39;s within an SQL Statement. Therefore, Guids require a custom <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/blob/master/src/ServiceStack.OrmLite.SqlServer/Converters/SqlServerGuidConverter.cs" target="_blank" rel="noopener noreferrer">SqlServerGuidConverter</a> to support Guids in SQL Server which looks like:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SqlServerGuidConverter</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">GuidConverter</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> ColumnDefinition <span class="token operator">=&gt;</span> <span class="token string">&quot;UniqueIdentifier&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> <span class="token function">ToQuotedString</span><span class="token punctuation">(</span><span class="token class-name">Type</span> fieldType<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">object</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token interpolation-string"><span class="token string">$&quot;CAST(&#39;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token expression language-csharp"><span class="token punctuation">(</span>Guid<span class="token punctuation">)</span><span class="token keyword">value</span></span><span class="token punctuation">}</span></span><span class="token string">&#39; AS UNIQUEIDENTIFIER)&quot;</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="registering-converters" tabindex="-1">Registering Converters <a class="header-anchor" href="#registering-converters" aria-hidden="true">#</a></h2><p>To get OrmLite to use this new Custom Converter for SQL Server, the <code>SqlServerOrmLiteDialectProvider</code> just <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/blob/41226795fc12f1b65d6af70c177a5ff57fa70334/src/ServiceStack.OrmLite.SqlServer/SqlServerOrmLiteDialectProvider.cs#L41" target="_blank" rel="noopener noreferrer">registers it in its constructor</a>:</p><div class="language-csharp"><pre><code><span class="token keyword">base</span><span class="token punctuation">.</span><span class="token generic-method"><span class="token function">RegisterConverter</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Guid<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlServerGuidConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>i.e. overriding the pre-registered <code>GuidConverter</code> to enable its extended functionality in SQL Server.</p><p>You&#39;ll also use the same <code>RegisterConverter&lt;T&gt;()</code> API to register your own Custom Guid Coverter on the RDBMS provider you want it to apply to, e.g for SQL Server:</p><div class="language-csharp"><pre><code>SqlServerDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">RegisterConverter</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Guid<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">MyCustomGuidConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="resolving-converters" tabindex="-1">Resolving Converters <a class="header-anchor" href="#resolving-converters" aria-hidden="true">#</a></h2><p>If needed, it can be later retrieved with:</p><div class="language-csharp"><pre><code><span class="token class-name">IOrmLiteConverter</span> converter <span class="token operator">=</span> SqlServerDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">GetConverter</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Guid<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token class-name"><span class="token keyword">var</span></span> myGuidConverter <span class="token operator">=</span> <span class="token punctuation">(</span>MyCustomGuidConverter<span class="token punctuation">)</span>converter<span class="token punctuation">;</span>
</code></pre></div><h2 id="debugging-converters" tabindex="-1">Debugging Converters <a class="header-anchor" href="#debugging-converters" aria-hidden="true">#</a></h2><p>Custom Converters also makes it easier to debug Type issues where if you want to see what value gets retrieved from the database, you can override and add a breakpoint on the base method letting you inspect the value returned from the <a href="http://ADO.NET" target="_blank" rel="noopener noreferrer">ADO.NET</a> Data Reader:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCustomGuidConverter</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">SqlServerGuidConverter</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">FromDbValue</span><span class="token punctuation">(</span><span class="token class-name">Type</span> fieldType<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">object</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">FromDbValue</span><span class="token punctuation">(</span>fieldType<span class="token punctuation">,</span> <span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//add breakpoint</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="enhancing-an-existing-converter" tabindex="-1">Enhancing an existing Converter <a class="header-anchor" href="#enhancing-an-existing-converter" aria-hidden="true">#</a></h2><p>An example of when you&#39;d want to do this is if you wanted to use the <code>Guid</code> property in your POCO&#39;s on legacy tables which stored Guids in <code>VARCHAR</code> columns, in which case you can also add support for converting the returned strings back into Guid&#39;s with:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyCustomGuidConverter</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">SqlServerGuidConverter</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">FromDbValue</span><span class="token punctuation">(</span><span class="token class-name">Type</span> fieldType<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">object</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> strValue <span class="token operator">=</span> <span class="token keyword">value</span> <span class="token keyword">as</span> <span class="token class-name"><span class="token keyword">string</span></span><span class="token punctuation">;</span> 
        <span class="token keyword">return</span> strValue <span class="token operator">!=</span> <span class="token keyword">null</span>
            <span class="token punctuation">?</span> <span class="token keyword">new</span> <span class="token constructor-invocation class-name">Guid</span><span class="token punctuation">(</span>strValue<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">:</span> <span class="token keyword">base</span><span class="token punctuation">.</span><span class="token function">FromDbValue</span><span class="token punctuation">(</span>fieldType<span class="token punctuation">,</span> <span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="sql-server-time-converter" tabindex="-1">SQL Server TIME Converter <a class="header-anchor" href="#sql-server-time-converter" aria-hidden="true">#</a></h2><p>Another popular Use Case now enabled with Converters is being able to override built-in functionality based on preference. E.g. by default TimeSpans are stored in the database as Ticks in a <code>BIGINT</code> column since it&#39;s the most reliable way to retain the same TimeSpan value uniformly across all RDBMS&#39;s.</p><p>E.g. SQL Server&#39;s <strong>TIME</strong> data type can&#39;t store Times greater than 24 hours or with less precision than <strong>3ms</strong>. But if using a <strong>TIME</strong> column was preferred it can now be enabled by registering to use the new <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/blob/master/src/ServiceStack.OrmLite.SqlServer/Converters/SqlServerTimeConverter.cs" target="_blank" rel="noopener noreferrer">SqlServerTimeConverter</a> instead:</p><div class="language-csharp"><pre><code>SqlServerDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">RegisterConverter</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>TimeSpan<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlServerTimeConverter</span> <span class="token punctuation">{</span> 
       Precision <span class="token operator">=</span> <span class="token number">7</span> 
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="customizable-field-definitions" tabindex="-1">Customizable Field Definitions <a class="header-anchor" href="#customizable-field-definitions" aria-hidden="true">#</a></h2><p>Another benefit is they allow for easy customization as seen with <code>Precision</code> property which will now create tables using the <code>TIME(7)</code> Column definition for TimeSpan properties.</p><h2 id="compact-guid-converters" tabindex="-1">Compact Guid Converters <a class="header-anchor" href="#compact-guid-converters" aria-hidden="true">#</a></h2><p>For RDBMS&#39;s that don&#39;t have a native <code>Guid</code> type like Oracle or Firebird, you had an option to choose whether you wanted to save them as text for better readability (default) or in a more efficient compact binary format. Previously this preference was maintained in a boolean flag along with multiple Guid implementations hard-coded at different entry points within each DialectProvider. This complexity has now been removed, now to store guids in a compact binary format you&#39;ll instead register the preferred Converter implementation, e.g:</p><div class="language-csharp"><pre><code>FirebirdDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">RegisterConverter</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Guid<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span>
    <span class="token keyword">new</span> <span class="token constructor-invocation class-name">FirebirdCompactGuidConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="string-converters" tabindex="-1">String Converters <a class="header-anchor" href="#string-converters" aria-hidden="true">#</a></h2><p>To customize the behavior of how strings are stored you can change them directly on the <code>StringConverter</code>, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name">StringConverter</span> converter <span class="token operator">=</span> OrmLiteConfig<span class="token punctuation">.</span>DialectProvider<span class="token punctuation">.</span><span class="token function">GetStringConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
converter<span class="token punctuation">.</span>UseUnicode <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
converter<span class="token punctuation">.</span>StringLength <span class="token operator">=</span> <span class="token number">100</span><span class="token punctuation">;</span>
</code></pre></div><p>Which will change the default column definitions for strings to use <code>NVARCHAR(100)</code> for RDBMS&#39;s that support Unicode or <code>VARCHAR(100)</code> for those that don&#39;t.</p><p>The <code>GetStringConverter()</code> API is just an extension method wrapping the generic <code>GetConverter()</code> API to return a concrete type:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token return-type class-name">StringConverter</span> <span class="token function">GetStringConverter</span><span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token class-name">IOrmLiteDialectProvider</span> d<span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>StringConverter<span class="token punctuation">)</span>d<span class="token punctuation">.</span><span class="token function">GetConverter</span><span class="token punctuation">(</span><span class="token keyword">typeof</span><span class="token punctuation">(</span><span class="token type-expression class-name"><span class="token keyword">string</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="datetime-converters" tabindex="-1">DateTime Converters <a class="header-anchor" href="#datetime-converters" aria-hidden="true">#</a></h2><h3 id="specify-the-datekind-in-datetimes" tabindex="-1">Specify the DateKind in DateTimes <a class="header-anchor" href="#specify-the-datekind-in-datetimes" aria-hidden="true">#</a></h3><p>It&#39;s now much simpler and requires less effort to implement new features that maintain the same behavior across all supported RDBMS thanks to better cohesion, re-use and reduced internal state. One new feature we&#39;ve added as a result is the new <code>DateStyle</code> customization on <code>DateTimeConverter</code> which lets you change how Dates are persisted and populated, e.g:</p><div class="language-csharp"><pre><code><span class="token class-name">DateTimeConverter</span> dates <span class="token operator">=</span> OrmLiteConfig<span class="token punctuation">.</span>DialectProvider<span class="token punctuation">.</span><span class="token function">GetDateTimeConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
dates<span class="token punctuation">.</span>DateStyle <span class="token operator">=</span> DateTimeKind<span class="token punctuation">.</span>Local<span class="token punctuation">;</span>
</code></pre></div><p>Will save <code>DateTime</code> in the database and populate them back on data models as LocalTime. This is also available for Utc:</p><div class="language-csharp"><pre><code>dates<span class="token punctuation">.</span>DateStyle <span class="token operator">=</span> DateTimeKind<span class="token punctuation">.</span>Utc<span class="token punctuation">;</span>
</code></pre></div><p>Default is <code>Unspecified</code> which doesn&#39;t do any conversions and just uses the DateTime returned by the <a href="http://ADO.NET" target="_blank" rel="noopener noreferrer">ADO.NET</a> provider. Examples of the behavior of the different DateStyle&#39;s is available in <a href="https://github.com/ServiceStack/ServiceStack.OrmLite/blob/master/tests/ServiceStack.OrmLite.Tests/DateTimeTests.cs" target="_blank" rel="noopener noreferrer">DateTimeTests</a>.</p><h2 id="noda-time" tabindex="-1">Noda Time <a class="header-anchor" href="#noda-time" aria-hidden="true">#</a></h2><p>SQL Server Converter for <a href="http://nodatime.org/" target="_blank" rel="noopener noreferrer">NodaTime</a> <code>Instant</code> Type in <code>DATETIMEOFFSET</code> with TimeZone:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SqlServerInstantConverter</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">OrmLiteConverter</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> ColumnDefinition <span class="token operator">=&gt;</span> <span class="token string">&quot;DATETIMEOFFSET&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name">DbType</span> DbType <span class="token operator">=&gt;</span> DbType<span class="token punctuation">.</span>DateTimeOffset<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">ToDbValue</span><span class="token punctuation">(</span><span class="token class-name">Type</span> fieldType<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">object</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> instantValue <span class="token operator">=</span> <span class="token punctuation">(</span>Instant<span class="token punctuation">)</span><span class="token keyword">value</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> instantValue<span class="token punctuation">.</span><span class="token function">ToDateTimeOffset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">FromDbValue</span><span class="token punctuation">(</span><span class="token class-name">Type</span> fieldType<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">object</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> Instant<span class="token punctuation">.</span><span class="token function">FromDateTimeOffset</span><span class="token punctuation">(</span><span class="token punctuation">(</span>DateTimeOffset<span class="token punctuation">)</span><span class="token keyword">value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

SqlServerDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">RegisterConverter</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Instant<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlServerInstantConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>In <code>DATETIME2</code> in UTC:</p><div class="language-csharp"><pre><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SqlServerInstantDateTimeConverter</span> <span class="token punctuation">:</span> <span class="token type-list"><span class="token class-name">OrmLiteConverter</span></span>
<span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">string</span></span> ColumnDefinition <span class="token operator">=&gt;</span> <span class="token string">&quot;DATETIME2&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name">DbType</span> DbType <span class="token operator">=&gt;</span> DbType<span class="token punctuation">.</span>DateTime<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">ToDbValue</span><span class="token punctuation">(</span><span class="token class-name">Type</span> fieldType<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">object</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> instantValue <span class="token operator">=</span> <span class="token punctuation">(</span>Instant<span class="token punctuation">)</span> <span class="token keyword">value</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> instantValue<span class="token punctuation">.</span><span class="token function">ToDateTimeUtc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">override</span> <span class="token return-type class-name"><span class="token keyword">object</span></span> <span class="token function">FromDbValue</span><span class="token punctuation">(</span><span class="token class-name">Type</span> fieldType<span class="token punctuation">,</span> <span class="token class-name"><span class="token keyword">object</span></span> <span class="token keyword">value</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token class-name"><span class="token keyword">var</span></span> dateTime <span class="token operator">=</span> DateTime<span class="token punctuation">.</span><span class="token function">SpecifyKind</span><span class="token punctuation">(</span><span class="token punctuation">(</span>DateTime<span class="token punctuation">)</span><span class="token keyword">value</span><span class="token punctuation">,</span> DateTimeKind<span class="token punctuation">.</span>Utc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> Instant<span class="token punctuation">.</span><span class="token function">FromDateTimeUtc</span><span class="token punctuation">(</span>dateTime<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

SqlServerDialect<span class="token punctuation">.</span>Provider<span class="token punctuation">.</span><span class="token generic-method"><span class="token function">RegisterConverter</span><span class="token generic class-name"><span class="token punctuation">&lt;</span>Instant<span class="token punctuation">&gt;</span></span></span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token constructor-invocation class-name">SqlServerInstantDateTimeConverter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="sql-server-types" tabindex="-1">SQL Server Types <a class="header-anchor" href="#sql-server-types" aria-hidden="true">#</a></h2><p>See <a href="./sql-server-features.html#sql-server-types">SQL Server Types</a> for how to enable support for SQL Server-specific <code>SqlGeography</code>, <code>SqlGeometry</code> and <code>SqlHierarchyId</code> Types.</p>`,54),p=[o];function c(r,i,l,u,k,d){return a(),s("div",null,p)}var m=n(t,[["render",c]]);export{h as __pageData,m as default};
